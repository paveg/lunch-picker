openapi: 3.1.0
info:
  title: Lunch Picker API
  version: 0.1.0
servers:
  - url: /api
paths:
  /search:
    post:
      summary: Search for lunch spots
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SearchRequest'
      responses:
        '200':
          description: List of restaurants
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SearchResponse'
components:
  schemas:
    Coordinates:
      type: object
      required:
        - lat
        - lng
      properties:
        lat:
          type: number
        lng:
          type: number
    SearchRequest:
      type: object
      required:
        - location
        - radius_m
      properties:
        location:
          $ref: '#/components/schemas/Coordinates'
        radius_m:
          type: integer
          minimum: 0
        cuisine:
          type: array
          items:
            type: string
          default: []
        budget:
          anyOf:
            - type: 'null'
            - type: object
              required:
                - max
              properties:
                max:
                  type: number
        limit:
          type: integer
          minimum: 1
          default: 5
    SearchResult:
      type: object
      required:
        - place_id
        - name
        - gmaps_url
        - distance_m
        - static_map_url
      properties:
        place_id:
          type: string
        name:
          type: string
        rating:
          type: number
          nullable: true
        distance_m:
          type: number
        price_level:
          type: string
          nullable: true
        open_now:
          type: boolean
          nullable: true
        fit_score:
          type: number
          description: Combined score derived from rating, distance, price level, and open state.
        static_map_url:
          type: string
        gmaps_url:
          type: string
        address:
          type: string
          nullable: true
        types:
          type: array
          items:
            type: string
    SearchResponse:
      type: object
      properties:
        results:
          type: array
          items:
            $ref: '#/components/schemas/SearchResult'
        cachedAt:
          type: integer
          description: Epoch millis when the response was cached.
